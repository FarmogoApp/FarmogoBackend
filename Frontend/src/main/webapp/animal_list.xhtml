<ui:composition template="layout.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
>
    <ui:define name="content">
        <h:head>
            <title>Animal List</title>
        </h:head>

        <p:growl id="msgs" showDetail="true"/>

        <h1>Animal List</h1>
        <h:form id="animalListForm">

            <p:commandButton value="Add"
                             icon="pi pi-plus-circle"
                             actionListener="#{animalListView.clearSelection}"
                             update="newAnimalDialog"
                             oncomplete="PF('newAnimalDialog').show()"
            />


            <p:dataTable
                    id="animalTable"
                    value="#{animalListView.animalList}"
                    var="elem"
                    rowKey="#{elem.uuid}"
                    selectionMode="single"
                    selection="#{animalListView.animal}">

                <p:column headerText="UUID">
                    <h:outputText value="#{elem.uuid}"/>
                </p:column>

                <p:column headerText="Origin">
                    <p:cellEditor>
                        <f:facet name="output"><h:outputText value="#{elem.origin}"/></f:facet>
                        <f:facet name="input"><p:inputText value="#{elem.origin}" style="width:100%"/></f:facet>
                    </p:cellEditor>
                </p:column>

            </p:dataTable>

            <p:contextMenu for="animalTable">
                <p:menuitem value="Edit" update="newAnimalDialog"
                            oncomplete="PF('newAnimalDialog').show()"/>

                <p:menuitem value="Delete" update="animalTable" action="#{animalListView.delete}">
                    <p:confirm header="Delete" message="Are you sure?" icon="pi pi-exclamation-triange"/>
                </p:menuitem>
            </p:contextMenu>

            <p:confirmDialog global="true">
                <p:commandButton value="Yes" type="button" styleClass="ui-confirmdialog-yes" icon="pi pi-check" />
                <p:commandButton value="No" type="button" styleClass="ui-confirmdialog-no" icon="pi pi-times" />
            </p:confirmDialog>

        </h:form>

        <p:dialog modal="false" closable="true" id="newAnimalDialog" widgetVar="newAnimalDialog">
            <f:facet name="header">
                New Animal
            </f:facet>
            <h:form id="newAnimal">
                <p:panelGrid columns="2">

                    <h:outputLabel value="Origin"/>
                    <p:column id="originColumn">
                        <p:inputText id="origin" value="#{animalListView.animal.origin}" required="true" />
                        <p:message for="origin"/>
                    </p:column>

                    <p:column/>
                    <p:commandButton value="Save" icon="pi pi-save"
                                     actionListener="#{animalListView.save}"
                                     update=":animalListForm:animalTable,originColumn"
                                     oncomplete="PF('newAnimalDialog').hide()"/>
                </p:panelGrid>
            </h:form>

        </p:dialog>

    </ui:define>
</ui:composition>